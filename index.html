<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>My Phaser Demos</title>
    <script src="lib/phaser.min.js"></script>
    <script src="game/js/Configuration.js"></script>
    <script src="game/js/Disc.js"></script>
    <script src="game/js/PlayerDisc.js"></script>
    <script src="game/js/TrailManager.js"></script>
    <script src="game/js/Trail.js"></script>
    <script src="game/js/Grid.js"></script>
    <script src="game/js/Collect.js"></script>
    <script src="game/js/CollectManager.js"></script>
    <script src="game/js/DiscManager.js"></script>
    <script src="game/js/BackgroundGradient.js"></script>
</head>
<body>
<script>
    // toots
    // https://github.com/grapefrukt/juicy-breakout
    // http://www.addlime.com/blog/exploding-sprites-phaser-js-shatter-js/
    // http://morgandemilly.com/blog/2015/04/phaserjs-cocoonjs-tips-tricks/
    var game = new Phaser.Game(1242, 2208, Phaser.AUTO, '');
    var config;
    var discManager;

    var MainState = function () {
    };

    MainState.prototype = {
        preload: function () {
            config = Configuration(game);
            this.game.scale.scaleMode = Phaser.ScaleManager.SHOW_ALL;
            game.stage.backgroundColor = config.colors.backgroundColor;
            game.load.image(config.sprites.playerDisc.key, config.sprites.playerDisc.path);
            game.load.image(config.sprites.disc.key, config.sprites.disc.path);
            game.load.image(config.sprites.grid.key, config.sprites.grid.path);
            game.load.image(config.sprites.trail.key, config.sprites.trail.path);
            game.load.image(config.sprites.collect.key, config.sprites.collect.path);
//            var hammer = new Hammer(this.game.canvas);
//            hammer.get('pan').set({direction: Hammer.DIRECTION_ALL});
//            hammer.on("swipeleft swiperight swipeup swipedown", function (ev) {
//                console.log("ev " + ev.type);
//            });
        },

        create: function () {
            //game.time.advancedTiming = true;
            game.physics.startSystem(Phaser.Physics.ARCADE);
            var bgGradient = new BackgroundGradient();
            bgGradient.add();
            var grid = new Grid(game.stage.width / 2, game.stage.height / 2);
            grid.add();
            var playerDisc = new PlayerDisc(game.stage.width / 2, game.stage.height / 2);
            discManager = new DiscManager(playerDisc);
            discManager.startAttacking();
            new CollectManager(playerDisc).start();
        },

        update: function () {
            //console.log("game.time.fps: " + game.time.fps);
        }

    };

    game.state.add('MainState', MainState, true);

</script>
</body>
</html>